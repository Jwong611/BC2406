library(data.table)
library(ggplot2)

data <- fread("Lawsuit.csv")
summary(data)

data[,Avg_sal := (data$Sal94 + data$Sal95)/2]

ggplot(data , aes(x = factor(Gender), y = Avg_sal)) + geom_boxplot()

ggplot(data , aes(x = factor(Gender), y = Exper)) + geom_boxplot()



ggplot(data , aes(x = Exper, y = Avg_sal)) + geom_point()


ggplot(data , aes(x = factor(Gender), y = Prate)) + geom_boxplot()

ggplot(data , aes(x = factor(Rank), fill = factor(Gender))) + geom_bar(position= "stack") 
ggplot(data , aes(x = factor(Cert), fill = factor(Gender))) + geom_bar(position= "stack") 
ggplot(data , aes(x = factor(Clin), fill = factor(Gender))) + geom_bar(position= "stack") 

cor(data$Exper, data$Avg_sal)

cor(data$Gender, data$Avg_sal)
cor(data$Gender, data$Rank)
cor(data$Gender, data$Exper)
cor(data$Gender, data$Prate)
cor(data$Gender, data$Cert)
cor(data$Gender, data$Clin)
cor(data$Gender, data$Dept)

# prate v rank
ggplot(data, aes(x = factor(Rank), y = Prate)) + geom_boxplot() + labs(title = "Prate vs Rank")

# prate v salary
data[,Avg_sal := (data$Sal94 + data$Sal95)/2]
ggplot(data, aes(x = Prate, y = Avg_sal)) + geom_point() + labs(title = "Prate vs Average Salary") # no splitting
ggplot(data, aes(x = Prate, y = Avg_sal)) + geom_point() + labs(title = "Prate vs Average Salary") + facet_wrap(~ Gender) # split by gender

# prate v gender
ggplot(data, aes(x = factor(Gender), y = Prate)) + geom_boxplot() + labs(title = "Prate vs Gender")

#rank vs gender
ggplot(data , aes(x = factor(Rank), fill = factor(Gender))) + geom_bar(position= "stack") + labs(title = "Rank VS Gender")
#correlation 
cor(data$Gender, data$Rank)

#rank vs experience
ggplot(data , aes(x = factor(Rank), y = Exper)) + geom_boxplot() + labs(title="Rank VS Experience")
#correlation
cor(data$Rank , data$Exper)

#gender vs experience
ggplot(data , aes(x = factor(Gender), y = Exper)) + geom_boxplot() + labs(title="Gender VS Experience")
#correlation
cor(data$Gender, data$Exper)
